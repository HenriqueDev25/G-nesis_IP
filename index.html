<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Gênesis Endereço IP</title>
    <!-- Importando fontes do Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Ícones do Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1565c0;
            --primary-dark: #0d47a1;
            --primary-light: #5e92f3;
            --dark: #263238;
            --light: #f5f9ff;
            --gray: #607d8b;
            --card-bg: #ffffff;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        }

        /* Reset moderno */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--gradient);
            color: var(--dark);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwwLjA1KSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==');
            opacity: 0.6;
        }

        .container {
            background-color: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 450px;
            padding: 40px;
            position: relative;
            z-index: 1;
            margin: 20px;
        }

        .logo-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            width: 120px;
            height: auto;
        }

        h1, h2 {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary-dark);
            text-align: center;
            margin-bottom: 20px;
        }

        h2 {
            font-size: 1.8rem;
            position: relative;
            padding-bottom: 15px;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--gradient);
            border-radius: 2px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray);
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            font-size: 1rem;
            border: 1px solid rgba(21, 101, 192, 0.2);
            border-radius: 8px;
            background-color: var(--light);
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(21, 101, 192, 0.1);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 15px;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(21, 101, 192, 0.3);
        }

        .btn i {
            margin-right: 10px;
        }

        .btn-secondary {
            background: white;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-secondary:hover {
            background: rgba(21, 101, 192, 0.05);
        }

        .hidden {
            display: none;
        }

        .infobox {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            text-align: center;
            display: none;
        }

        .infobox.success {
            background-color: #e6f7ee;
            color: #207a23;
            border: 1px solid #c3e6cb;
        }

        .infobox.error {
            background-color: #fde8e8;
            color: #da1e1e;
            border: 1px solid #f5c6cb;
        }

        .info-text {
            margin-top: 20px;
            font-size: 0.9rem;
            color: var(--gray);
            text-align: center;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .info-text:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        /* Tela de busca de IP */
        .search-container {
            margin-top: 30px;
        }

        .search-box {
            width: 100%;
            padding: 15px;
            font-size: 1rem;
            border: 1px solid rgba(21, 101, 192, 0.2);
            border-radius: 8px;
            margin-bottom: 20px;
            background-color: var(--light);
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(21, 101, 192, 0.1);
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: var(--light);
            border-radius: 8px;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .result.success {
            color: #207a23;
            border-left: 4px solid #207a23;
        }

        .result.error {
            color: #da1e1e;
            border-left: 4px solid #da1e1e;
        }

        /* Janela de informações */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .info-window {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 500px;
            width: 90%;
            display: none;
        }

        .info-window h3 {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary-dark);
            margin-bottom: 20px;
            text-align: center;
        }

        .info-window p {
            color: var(--gray);
            margin-bottom: 25px;
            line-height: 1.6;
        }

        /* Novos estilos para a busca de IP */
        .ip-details {
            margin-top: 20px;
        }

        .ip-detail-row {
            display: flex;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .ip-detail-label {
            font-weight: 600;
            min-width: 120px;
            color: var(--primary-dark);
        }

        .ip-detail-value {
            flex: 1;
        }

        .map-container {
            margin-top: 20px;
            height: 200px;
            background-color: #f5f5f5;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
        }

        .map-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--gray);
        }

        .history-container {
            margin-top: 20px;
        }

        .history-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .history-item:hover {
            background-color: #f5f9ff;
        }

        .history-ip {
            font-weight: 600;
            color: var(--primary);
        }

        .history-location {
            font-size: 0.8rem;
            color: var(--gray);
        }

        .clear-history {
            text-align: right;
            margin-top: 10px;
        }

        .clear-history-btn {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 0.8rem;
            cursor: pointer;
            text-decoration: underline;
        }

        .clear-history-btn:hover {
            color: var(--primary-dark);
        }

        /* Responsividade */
        @media (max-width: 768px) {
            .container {
                padding: 30px;
            }
            
            h2 {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 25px;
                margin: 15px;
            }
            
            h2 {
                font-size: 1.3rem;
            }
            
            .form-group input, .search-box {
                padding: 12px;
            }
            
            .btn {
                padding: 12px;
            }
            
            .ip-detail-label {
                min-width: 100px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div id="loginScreen">
        <div class="container">
            <div class="logo-container">
                <img src="logo.png" alt="Logo Projeto Gênesis" class="logo">
            </div>
            <h2 id="loginTitle">Login</h2>

            <!-- Infobox para mensagens -->
            <div id="infobox" class="infobox hidden"></div>

            <div id="loginForm">
                <div class="form-group">
                    <label for="username">Usuário:</label>
                    <input type="text" id="username" placeholder="Digite seu usuário">
                </div>
                <div class="form-group">
                    <label for="password">Senha:</label>
                    <input type="password" id="password" placeholder="Digite sua senha">
                </div>
                <div class="form-group">
                    <button class="btn" onclick="login()">
                        <i class="fas fa-sign-in-alt"></i> Entrar
                    </button>
                </div>
                <div class="form-group">
                    <button class="btn btn-secondary" onclick="showRegisterForm()">
                        <i class="fas fa-user-plus"></i> Cadastrar-se
                    </button>
                </div>
                <div class="info-text" onclick="showInfoWindow()">
                    Clique aqui para mais informações sobre o Gênesis
                </div>
            </div>

            <div id="registerForm" class="hidden">
                <div class="form-group">
                    <label for="newUsername">Novo Usuário:</label>
                    <input type="text" id="newUsername" placeholder="Escolha um nome de usuário">
                </div>
                <div class="form-group">
                    <label for="newPassword">Nova Senha:</label>
                    <input type="password" id="newPassword" placeholder="Escolha uma senha">
                </div>
                <div class="form-group">
                    <button class="btn" onclick="register()">
                        <i class="fas fa-user-check"></i> Cadastrar
                    </button>
                </div>
                <div class="form-group">
                    <button class="btn btn-secondary" onclick="showLoginForm()">
                        <i class="fas fa-arrow-left"></i> Voltar ao Login
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tela de Busca de IP -->
    <div id="ipScreen" class="hidden">
        <div class="container">
            <div class="logo-container">
                <img src="logo.png" alt="Logo Projeto Gênesis" class="logo">
            </div>
            <h2>Buscar Endereço IP</h2>
            
            <div class="search-container">
                <input type="text" class="search-box" id="ipInput" placeholder="Digite um endereço IP (ex: 8.8.8.8)">
                <div class="form-group">
                    <button class="btn" onclick="buscarEndereco()">
                        <i class="fas fa-search"></i> Buscar
                    </button>
                </div>
                
                <div id="resultado" class="result"></div>
                
                <div id="ipDetails" class="ip-details hidden">
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">Endereço IP:</div>
                        <div class="ip-detail-value" id="detail-ip"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">Tipo:</div>
                        <div class="ip-detail-value" id="detail-type"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">Continente:</div>
                        <div class="ip-detail-value" id="detail-continent"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">País:</div>
                        <div class="ip-detail-value" id="detail-country"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">Região:</div>
                        <div class="ip-detail-value" id="detail-region"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">Cidade:</div>
                        <div class="ip-detail-value" id="detail-city"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">CEP:</div>
                        <div class="ip-detail-value" id="detail-zip"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">Provedor:</div>
                        <div class="ip-detail-value" id="detail-isp"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">Localização:</div>
                        <div class="ip-detail-value" id="detail-location"></div>
                    </div>
                    <div class="ip-detail-row">
                        <div class="ip-detail-label">Fuso Horário:</div>
                        <div class="ip-detail-value" id="detail-timezone"></div>
                    </div>
                    
                    <div class="map-container" id="mapContainer">
                        <div class="map-placeholder">
                            <i class="fas fa-map-marked-alt"></i> Mapa será exibido aqui
                        </div>
                    </div>
                </div>
                
                <div class="history-container" id="historyContainer">
                    <h3>Histórico de Buscas</h3>
                    <div id="historyList"></div>
                    <div class="clear-history">
                        <button class="clear-history-btn" onclick="clearSearchHistory()">
                            <i class="fas fa-trash"></i> Limpar histórico
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sobreposição para escurecer o fundo -->
    <div id="overlay" class="overlay"></div>

    <!-- Janela de Informações -->
    <div id="infoWindow" class="info-window">
        <h3>Informações sobre o Gênesis</h3>
        <p>O Projeto Gênesis tem como objetivo principal democratizar o acesso a ferramentas que, atualmente, são restritas ou de difícil alcance para a maioria da sociedade. Um exemplo disso é a localização por IP.</p>
        <div class="form-group">
            <button class="btn" onclick="hideInfoWindow()">
                <i class="fas fa-times"></i> Fechar
            </button>
        </div>
    </div>

    <script>
        // Função para exibir a infobox
        function showInfobox(message, type) {
            const infobox = document.getElementById('infobox');
            infobox.innerText = message;
            infobox.className = `infobox ${type}`;
            infobox.style.display = 'block';

            setTimeout(() => {
                infobox.style.display = 'none';
            }, 3000);
        }

        // Função para carregar usuários do localStorage
        function loadUsers() {
            const users = localStorage.getItem('users');
            return users ? JSON.parse(users) : [];
        }

        // Função para salvar usuários no localStorage
        function saveUsers(users) {
            localStorage.setItem('users', JSON.stringify(users));
        }

        // Mostrar o formulário de registro
        function showRegisterForm() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.remove('hidden');
            document.getElementById('loginTitle').innerText = "Cadastro";
        }

        // Mostrar o formulário de login
        function showLoginForm() {
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('loginTitle').innerText = "Login";
        }

        // Função para login
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const users = loadUsers();
            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                showInfobox("Login efetuado com sucesso!", "success");
                setTimeout(() => {
                    document.getElementById('loginScreen').classList.add('hidden');
                    document.getElementById('ipScreen').classList.remove('hidden');
                    loadSearchHistory();
                }, 1000);
            } else {
                showInfobox("Usuário ou senha incorretos.", "error");
            }
        }

        // Função para cadastrar um novo usuário
        function register() {
            const username = document.getElementById('newUsername').value;
            const password = document.getElementById('newPassword').value;

            if (username && password) {
                const users = loadUsers();

                // Verificar se o usuário já existe
                const existingUser = users.find(u => u.username === username);
                if (existingUser) {
                    showInfobox("Este usuário já está cadastrado.", "error");
                } else {
                    users.push({ username, password });
                    saveUsers(users);
                    showInfobox("Usuário cadastrado com sucesso! Você pode agora fazer login.", "success");
                    showLoginForm();
                }
            } else {
                showInfobox("Por favor, preencha todos os campos.", "error");
            }
        }

        // Função para validar formato de IP
        function isValidIP(ip) {
            // Regex para IPv4
            const ipv4Regex = /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
            
            // Regex para IPv6 (simplificado)
            const ipv6Regex = /^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$/;
            
            return ipv4Regex.test(ip) || ipv6Regex.test(ip);
        }

        // Carregar histórico de buscas
        function loadSearchHistory() {
            const history = getSearchHistory();
            const historyList = document.getElementById('historyList');
            
            if (history.length === 0) {
                historyList.innerHTML = '<div class="history-item">Nenhuma busca realizada ainda</div>';
                return;
            }
            
            historyList.innerHTML = '';
            history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div class="history-ip">${item.ip}</div>
                    <div class="history-location">${item.city ? `${item.city}, ${item.country}` : 'Local desconhecido'}</div>
                `;
                historyItem.addEventListener('click', () => {
                    document.getElementById('ipInput').value = item.ip;
                    buscarEndereco();
                });
                historyList.appendChild(historyItem);
            });
        }

        // Obter histórico de buscas
        function getSearchHistory() {
            const history = localStorage.getItem('ipSearchHistory');
            return history ? JSON.parse(history) : [];
        }

        // Adicionar item ao histórico
        function addToSearchHistory(data) {
            const history = getSearchHistory();
            
            // Verificar se o IP já está no histórico
            const existingIndex = history.findIndex(item => item.ip === data.ip);
            if (existingIndex !== -1) {
                history.splice(existingIndex, 1); // Remove o item existente
            }
            
            // Adiciona no início do array
            history.unshift(data);
            
            // Mantém apenas os últimos 10 itens
            if (history.length > 10) {
                history.pop();
            }
            
            localStorage.setItem('ipSearchHistory', JSON.stringify(history));
            loadSearchHistory();
        }

        // Limpar histórico de buscas
        function clearSearchHistory() {
            localStorage.removeItem('ipSearchHistory');
            loadSearchHistory();
        }

        // Função para exibir os detalhes do IP
        function displayIPDetails(data) {
            document.getElementById('ipDetails').classList.remove('hidden');
            
            // Preencher os detalhes
            document.getElementById('detail-ip').textContent = data.ip || 'N/A';
            document.getElementById('detail-type').textContent = data.type || 'N/A';
            document.getElementById('detail-continent').textContent = data.continent ? `${data.continent} (${data.continent_code})` : 'N/A';
            document.getElementById('detail-country').textContent = data.country ? `${data.country} (${data.country_code})` : 'N/A';
            document.getElementById('detail-region').textContent = data.region || 'N/A';
            document.getElementById('detail-city').textContent = data.city || 'N/A';
            document.getElementById('detail-zip').textContent = data.postal || 'N/A';
            document.getElementById('detail-isp').textContent = data.connection?.isp || data.isp || 'N/A';
            
            if (data.latitude && data.longitude) {
                document.getElementById('detail-location').textContent = `${data.latitude}, ${data.longitude}`;
                
                // Atualizar o mapa (usando OpenStreetMap)
                const mapContainer = document.getElementById('mapContainer');
                mapContainer.innerHTML = `
                    <iframe 
                        width="100%" 
                        height="100%" 
                        frameborder="0" 
                        scrolling="no" 
                        marginheight="0" 
                        marginwidth="0" 
                        src="https://www.openstreetmap.org/export/embed.html?bbox=${data.longitude-0.01}%2C${data.latitude-0.01}%2C${data.longitude+0.01}%2C${data.latitude+0.01}&amp;layer=mapnik&amp;marker=${data.latitude}%2C${data.longitude}">
                    </iframe>
                `;
            } else {
                document.getElementById('detail-location').textContent = 'N/A';
                document.getElementById('mapContainer').innerHTML = '<div class="map-placeholder"><i class="fas fa-map-marked-alt"></i> Dados de localização não disponíveis</div>';
            }
            
            document.getElementById('detail-timezone').textContent = data.timezone?.id || data.timezone || 'N/A';
        }

        // Função de busca de endereço IP
        function buscarEndereco() {
            const ip = document.getElementById("ipInput").value.trim();
            const resultadoDiv = document.getElementById("resultado");
            
            // Validar o IP
            if (!ip) {
                resultadoDiv.innerText = "Por favor, digite um endereço IP.";
                resultadoDiv.className = "result error";
                return;
            }
            
            if (!isValidIP(ip)) {
                resultadoDiv.innerText = "Formato de IP inválido. Use IPv4 (ex: 8.8.8.8) ou IPv6.";
                resultadoDiv.className = "result error";
                return;
            }
            
            // Verificar cache primeiro
            const cacheKey = `ipCache_${ip}`;
            const cachedData = localStorage.getItem(cacheKey);
            
            if (cachedData) {
                const data = JSON.parse(cachedData);
                resultadoDiv.innerHTML = `<i class="fas fa-check-circle"></i> Informações carregadas do cache.`;
                resultadoDiv.className = "result success";
                displayIPDetails(data);
                return;
            }
            
            // Mostrar loading
            resultadoDiv.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Buscando informações...';
            resultadoDiv.className = 'result';
            
            // Usar API mais robusta (ipapi.co)
            fetch(`https://ipapi.co/${ip}/json/`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('API limit reached or invalid response');
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.error) {
                        throw new Error(data.reason || 'IP inválido ou não encontrado');
                    }
                    
                    resultadoDiv.innerHTML = `<i class="fas fa-check-circle"></i> Informações encontradas!`;
                    resultadoDiv.className = "result success";
                    
                    // Salvar no cache (expira em 1 dia)
                    const cacheData = {
                        ...data,
                        cachedAt: Date.now()
                    };
                    localStorage.setItem(cacheKey, JSON.stringify(cacheData));
                    
                    // Adicionar ao histórico
                    addToSearchHistory(data);
                    
                    // Exibir detalhes
                    displayIPDetails(data);
                })
                .catch(error => {
                    // Se a primeira API falhar, tentar uma alternativa
                    fetch(`https://ipwhois.app/json/${ip}`)
                        .then(response => response.json())
                        .then(data => {
                            if (data.success === false) {
                                throw new Error(data.message || 'IP inválido ou não encontrado');
                            }
                            
                            resultadoDiv.innerHTML = `<i class="fas fa-check-circle"></i> Informações encontradas (fonte alternativa)!`;
                            resultadoDiv.className = "result success";
                            
                            // Salvar no cache (expira em 1 dia)
                            const cacheData = {
                                ...data,
                                cachedAt: Date.now()
                            };
                            localStorage.setItem(cacheKey, JSON.stringify(cacheData));
                            
                            // Adicionar ao histórico
                            addToSearchHistory(data);
                            
                            // Exibir detalhes
                            displayIPDetails(data);
                        })
                        .catch(error => {
                            resultadoDiv.innerText = `Erro: ${error.message || 'Não foi possível obter informações para este IP'}`;
                            resultadoDiv.className = "result error";
                            document.getElementById('ipDetails').classList.add('hidden');
                        });
                });
        }

        // Função para exibir a janela de informações e a sobreposição
        function showInfoWindow() {
            const infoWindow = document.getElementById('infoWindow');
            const overlay = document.getElementById('overlay');
            infoWindow.style.display = 'block';
            overlay.style.display = 'block';
        }

        // Função para esconder a janela de informações e a sobreposição
        function hideInfoWindow() {
            const infoWindow = document.getElementById('infoWindow');
            const overlay = document.getElementById('overlay');
            infoWindow.style.display = 'none';
            overlay.style.display = 'none';
        }

        // Limpar cache antigo ao carregar a página
        function cleanOldCache() {
            const now = Date.now();
            const oneDay = 24 * 60 * 60 * 1000; // 1 dia em milissegundos
            
            Object.keys(localStorage).forEach(key => {
                if (key.startsWith('ipCache_')) {
                    try {
                        const data = JSON.parse(localStorage.getItem(key));
                        if (data.cachedAt && (now - data.cachedAt) > oneDay) {
                            localStorage.removeItem(key);
                        }
                    } catch (e) {
                        // Se houver erro ao parsear, remove o item
                        localStorage.removeItem(key);
                    }
                }
            });
        }

        // Inicializar
        cleanOldCache();
    </script>
</body>
</html>
